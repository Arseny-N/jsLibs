var BarChart=function(d,c){var a={id:"canvas",axisOrigin:[30,25],barHeight:50,barWidth:300,barChartHeight:20,background:"#F9F9F9",textFromAxisDist:[30,25],scoreFromBarDist:10,key:"bar",font:{family:"Helvetica"},greenFill:{color:"#42E73A",opacity:0.8},redFill:{color:"#f03",opacity:0.6},barStroke:{stroke:"black",width:2,linejoin:"round",opacity:0.7},gridStroke:{width:1,opacity:0.6},borderStroke:{width:1,dasharray:"5,5",opacity:0.6},axis_prec:25};for(var b in a){if(typeof c[b]=="undefined"){c[b]=a[b]}}this.id=c.id;this.data=d;this.getValue=c.getValue;this.axisOrigin=c.axisOrigin;this.barHeight=c.barHeight;this.barWidth=c.barWidth;this.barChartHeight=c.barChartHeight;this.click=c.click;this.textFromAxisDist=c.textFromAxisDist;this.scoreFromBarDist=c.scoreFromBarDist;this.font=c.font;this.greenFill=c.greenFill;this.redFill=c.redFill;this.key=c.key;this.barStroke=c.barStroke;this.gridStroke=c.gridStroke;this.borderStroke=c.borderStroke;this.axis_prec=c.axis_prec;this.numBars=this.data.length;this.svg=c.svg?c.svg:SVG(this.id).size(c.Width?c.Width:this.barWidth+this.axisOrigin[0]+40,c.Height?c.Height:this.barHeight*this.numBars+this.axisOrigin[1]+40);this.drawBar=function(g,j){g.chart={};var h=this.axisOrigin[1]+(this.barHeight)*(j-0.5);var f=function(){g.chart.masterHit.animate(1000,"<>",10).opacity(0.4)};var e=function(){g.chart.masterHit.animate(1000,"<>",10).opacity(0)};g.chart.masterHit=this.svg.rect(this.barWidth,this.barHeight).opacity(0).x(this.axisOrigin[0]).cy(h).remember(this.key,g).mouseenter(f).mouseleave(e);g.chart.red=this.svg.rect(this.barWidth,this.barChartHeight).fill(this.redFill).x(this.axisOrigin[0]).cy(h).remember(this.key,g).mouseenter(f).mouseleave(e);g.chart.green=this.svg.rect((g.value/100)*(this.barWidth),this.barChartHeight).fill(this.greenFill).x(this.axisOrigin[0]).cy(h).remember(this.key,g).mouseenter(f).mouseleave(e);this.svg.text(g.label).font(this.font).x(this.axisOrigin[0]-this.textFromAxisDist[0]).cy(h);this.svg.text(g.value+"%").font(this.font).x(this.axisOrigin[0]+this.barWidth+this.scoreFromBarDist).cy(h);this.svg.line(this.axisOrigin[0],this.barHeight*j+this.axisOrigin[1],this.axisOrigin[0]+this.barWidth,(this.barHeight)*j+this.axisOrigin[1]).stroke(this.borderStroke);this.svg.polyline([[this.axisOrigin[0],h-this.barChartHeight/2],[this.axisOrigin[0]+this.barWidth,h-this.barChartHeight/2],[this.axisOrigin[0]+this.barWidth,h+this.barChartHeight/2],[this.axisOrigin[0],h+this.barChartHeight/2]]).fill("none").stroke(this.barStroke);if(this.click){g.chart.masterHit.click(this.click);g.chart.red.click(this.click);g.chart.green.click(this.click)}};this.drawBars=function(){var g=1;for(var e in this.data){var f=this.data[e];this.drawBar(f,g++)}};this.drawGrid=function(){var e=(this.barWidth*this.axis_prec)/100;for(i=0;i<=this.barWidth;i+=e){this.svg.line(this.axisOrigin[0]+i,this.axisOrigin[1],this.axisOrigin[0]+i,this.barHeight*this.numBars+this.axisOrigin[1]).stroke(this.gridStroke);this.svg.text(""+((i/e)*this.axis_prec)+"%").y(this.axisOrigin[1]-this.textFromAxisDist[1]).cx(this.axisOrigin[0]+i).font(this.font)}};this.drawAxis=function(){this.svg.line(this.axisOrigin[0],this.axisOrigin[1],this.axisOrigin[0],this.barHeight*this.numBars+this.axisOrigin[1]+12).stroke({width:1});this.svg.line(this.axisOrigin[0],this.axisOrigin[1],this.barWidth+this.axisOrigin[0]+12,this.axisOrigin[1]).stroke({width:1})};this.remove=function(){$(this.id+" svg").remove()};this.draw=function(){this.drawGrid();this.drawBars();this.drawAxis()};return this};