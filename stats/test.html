<!doctype html>
<html >

<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8" />
</head>
<body>
<script src="http://code.jquery.com/jquery-1.9.1.js"></script>	
<script type="text/javascript" src="svg.min.js" charset="utf-8"></script>
<script type="text/javascript" src="fuzzData.js" charset="utf-8"></script>
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js" charset="utf-8"></script>



<script type="text/javascript" src="PercentBars.js"></script>
<script type="text/javascript" src="PercentBarsOne.js"></script>
<script type="text/javascript" src="PercentBarsVertical.js"></script>
<script type="text/javascript" src="LineChart.js"></script>
<script type="text/javascript" src="drawStats.js"></script>

<script type="text/javascript" src="fuzzData.js"></script>


<script>
	$( function () { 
	var f = function(){
			return Math.floor(Math.random() *100)%3 -1;
		}
		var f2 = function(){
			return Math.floor(Math.random() *100);
		}
		var f3 = function(){
			return Math.floor(Math.random() *200);
		}
		
		var d2 =  new fuzzData, data= d2.dataBarA;
		
		function fillInData(info, elem) {
			console.dir(info);
			elem.find(".line-chart-heading").html(info.label + " "+info.labelplus);
			$("#line-info span").html("21");
			var text = elem.find(".line-chart-info span");
			text.eq(0).html(info.numSolvedTasks);		
			text.eq(1).html(info.totalNumTasks);
			text.eq(2).html(info.numSuccSolvedTasks);
			text.eq(3).html(info.numUnSuccSolvedTasks);
			$("#task-info").hide();
		
			
		}
		function fillInTaskData(info,elem) {
			console.dir(elem)
			elem.find(".task-info-container").show();
			var text = elem.find(".task-info-container span");
			text.eq(0).html(info.label.date +" в 	"+info.label.time);
			text.eq(1).html(info.taskCode); // HREF ????
			text.eq(2).html(info.userAnswer);
			text.eq(3).html(info.rightAnswer);
			text.eq(4).html(info.value == "0" ? "не решено" : 
						info.value == "1" ? "решено" : "решено не верно");
		}		
		
		var showTaskInfo = function () {
			fillInTaskData(this.remember('stats'),this.remember('arg'));			
			
			
		}	
		var showInfo = function (stats) {
			var id = $(stats['target']).parents('table.stats-table').attr('id');
			var line_chart = $( ".line-chart#" + id);
			var chart_body = line_chart.find('.line-chart-body');
			
			chart_body.find("svg").remove();

			lineChartOptions.id = chart_body.get(0)
			lineChartOptions["arg"] = line_chart;		
			new LineChart(stats['data'].subVals, lineChartOptions).draw();			
			line_chart.find(".task-info-container").hide();	

			fillInData(stats['data'], line_chart);
			
			
			line_chart.slideDown();	
			
			line_chart.find('.close-button').click(function(){
				$(this).slideUp();	
			}.bind(line_chart))
			
		};
		var lineChartOptions = 	{
				id: 'line-chart', key:'stats', 
				getValue: function (entry) { return entry.numSolved ? entry.numSuccSolved * 100 / entry.numSolved:0; }, 
		};

		lineChartOptions["click"] = showTaskInfo;

				
		
	 	//var B = new LineChart({}, lineChartOptions).draw();
	 	

		function drawBars(bars) {

			for(var i in bars) {	
				var b = bars[i]				
				$('.'+b.label +' div.graph .bar')
					.delay(600)
					.animate({'height': b.value }, 1000, "easeOutBounce");
				
				var e = $('.'+b.label);
				var onHoverIn = function() {
					this.css('background','#eee');

				}.bind(e)
				var onHoverOut = function() {
					this.css('background','#fff');
				}.bind(e)				
				var onClick = function(data) {
					showInfo(data);
				}
				
				e.hover(onHoverIn, onHoverOut);
				e.click(b, onClick);
				e.css('cursor','pointer');
			}
		}	
		drawBars(data);
	} );

	
</script>

        <style>
.stats-table td{
	width: 25px;
	text-align: center;
	background: #fff;
	border-radius: 0px;	
}
.stats-table th{
	text-align: center;
	background: #fff;
	border-radius: 0px;	
	color: #000;
}
.stats-table {
	font: 12px/14px sans-serif;
	border-spacing: 0px;
	margin: 20px 0px;
}
.stats-table th.horizontal-index{
	border: 1px solid rgb(201,201,201);
	border-top: 0px solid rgb(201,201,201);
}
.stats-table th.horizontal-index.vertical-index{
	border: 1px solid rgb(201,201,201);

}
.stats-table th.vertical-index{
	border: 1px solid rgb(201,201,201);
	border-left: 0px solid rgb(201,201,201);
}


.stats-table td.data-container {

	border: 1px solid rgb(201,201,201);
	border-top: 0px solid rgb(201,201,201);
}
.stats-table td.graph-container {
	padding: 0px;
	margin: 0px;
	width: 10px;
	height: 150px;
	border-bottom: 1px solid rgb(201,201,201);
}
.stats-table div.graph {
	/*background: red;*/
	height: 100%;
	width: 100%;
	margin: 0px auto;			
	position:relative;
}
.stats-table div.bar {
	background: green;
	width: 100%;
	height: 0px;
	position: absolute;
	bottom: 0px;
	border-radius: 2px 2px 0px 0px;
}
</style>
<style>
.line-chart {
	font: 12px/14px sans-serif;
	border-spacing: 0px;
}

.line-chart td.line-chart-container,.line-chart td.task-info-container,.line-chart td.line-chart-info {
	border: 1px solid rgb(201, 201, 201);	
	width: 400px;
	vertical-align: center;
}

table.line-chart  {
	max-width: 840px;
	border-spacing: 4px;
	box-shadow: 1px 1px 2px inset;
	padding: 2px 0px;
	display: none;
}
.line-chart  table {
	margin: 20px;
	
}
.line-chart td, .line-chart th{
	text-align: center;
}
.line-chart-info td {

}
.line-chart th{
	text-align: left;
	font-weight: normal;
	padding: 10px;
	width: 100px;
}
.line-chart div.task-info-container {
	margin-top: 12px;
}
.line-chart div.line-chart-heading {
	border-bottom: 1px solid rgb(201, 201, 201);	
	padding: 10px 20px;
	
}
.line-chart td.line-chart-buttons {
	border: 1px solid rgb(201, 201, 201);	
	width: 100%;
	vertical-align: center;
	padding: 2px;
	text-align: right;
	padding: 4px 8px 1px 8px;
}



.close-button {
	width: 20px;
	border-radius: 2px;
	background: #fff6cc;
	position: relative;
	left: 4px;
}
</style>
<body>
<div id="stats">
	
	<table class="stats-table" id="B" >
		<tr >
			<th class="horizontal-index vertical-index"	></th>
			<th colspan="2" class="vertical-index B1">B1</th>
			<th colspan="2" class="vertical-index B2">B1</th>		
		</tr>
		<tr >
			<th class="horizontal-index">Про­то­ти­пов в базе</th>
				<td class="graph-container B1" rowspan="4" > <div class="graph"><div class="bar"><div ></div></td>
				<td class="data-container B1">25</td>
				<td class="graph-container B2" rowspan="4" ><div class="graph" ><div class="bar"><div ></div></td>
				<td class="data-container B2">46</td>
		</tr>
		<tr >
			<th class="horizontal-index">Решалось</th>
			<td class="data-container B1">0</td>
			<td class="data-container B2">0</td>
		</tr>
		<tr >
			<th class="horizontal-index">Верно</th>
				<td class="data-container B1"><!--0% -->0</td>
				<td class="data-container B2"><!--0% -->0</td>
			</tr>
		<tr >
			<th class="horizontal-index">Статистика</th>
				<td class="data-container B1"><!--0% -->0</td>
				<td class="data-container B2"><!--0% -->0</td>
		</tr>
	</table>


</div>

<table class="line-chart" id="B" >
	<tr> <td colspan="3" class="line-chart-buttons"> <img class="close-button" src="icons/arrow1_n.png"/></td></tr>
	<tr>
			<td class="line-chart-container">
				<div class="line-chart-heading">
					Последние <span>20</span> решенные. Нажмите чтобы вывести инфомацию о задании.
				</div>	
				<div class="line-chart-body" id="line-chart"></div>
		
			</td>
			<td class="line-chart-info">
					<table>
						<tr><th>Решено всего			</th><td><span></span></td></tr>
						<tr><th>Количество заданий в банке	</th><td><span></span></td></tr>
						<tr><th>Решено верно			  </th><td><span></span></td></tr>
						<tr><th>Решено не верно/Пропущено </th><td><span></span></td></tr>
					</table>				
			</td>

			<td class="task-info-container">
					<table>
						<tr><th>Задание решено 			</th><td><span></span></td></tr>
						<tr><th>Код задания			</th><td><span></span></td></tr>
						<tr><th>Ваш ответ			</th><td><span></span></td></tr>
						<tr><th>Верный ответ			</th><td><span></span></td></tr>
						<tr><th>Статус				</th><td><span></span></td></tr>
					</table>				
			</td>
	</tr>
</table>

<div id="stats">
	
	<table class="stats-table" id="C" >
		<tr >
			<th class="horizontal-index vertical-index"	></th>
			<th colspan="2" class="vertical-index C1">B1</th>
			<th colspan="2" class="vertical-index C2">B1</th>		
		</tr>
		<tr >
			<th class="horizontal-index">Про­то­ти­пов в базе</th>
				<td class="graph-container C1" rowspan="4" > <div class="graph"><div class="bar"><div ></div></td>
				<td class="data-container C1">25</td>
				<td class="graph-container C2" rowspan="4" ><div class="graph" ><div class="bar"><div ></div></td>
				<td class="data-container C2">46</td>
		</tr>
		<tr >
			<th class="horizontal-index">Решалось</th>
			<td class="data-container C1">0</td>
			<td class="data-container C2">0</td>
		</tr>
		<tr >
			<th class="horizontal-index">Верно</th>
				<td class="data-container C1"><!--0% -->0</td>
				<td class="data-container C2"><!--0% -->0</td>
			</tr>
		<tr >
			<th class="horizontal-index">Статистика</th>
				<td class="data-container C1"><!--0% -->0</td>
				<td class="data-container C2"><!--0% -->0</td>
		</tr>
	</table>


</div>

<table class="line-chart" id="C" >
	<tr> <td colspan="3" class="line-chart-buttons"> <img class="close-button" src="icons/arrow1_n.png"/></td></tr>
	<tr>
			<td class="line-chart-container">
				<div class="line-chart-heading">
					Последние <span>20</span> решенные. Нажмите чтобы вывести инфомацию о задании.
				</div>	
				<div class="line-chart-body" id="line-chart"></div>
		
			</td>
			<td class="line-chart-info">
					<table>
						<tr><th>Решено всего			</th><td><span></span></td></tr>
						<tr><th>Количество заданий в банке	</th><td><span></span></td></tr>
						<tr><th>Решено верно			  </th><td><span></span></td></tr>
						<tr><th>Решено не верно/Пропущено </th><td><span></span></td></tr>
					</table>				
			</td>

			<td class="task-info-container">
					<table>
						<tr><th>Задание решено 			</th><td><span></span></td></tr>
						<tr><th>Код задания			</th><td><span></span></td></tr>
						<tr><th>Ваш ответ			</th><td><span></span></td></tr>
						<tr><th>Верный ответ			</th><td><span></span></td></tr>
						<tr><th>Статус				</th><td><span></span></td></tr>
					</table>				
			</td>
	</tr>
</table>
</body>





 	





