var LineChart=function(d,c){var a={id:"canvas",axisOrigin:[20,10],barHeight:100,barWidth:350,barChartHeight:20,background:"#F9F9F9",key:"stats",textFromAxisDist:[10,1960],scoreFromBarDist:10,pointSize:10,pointSizeInc:15,pointHitSize:50,font:{family:"Helvetica",size:12},barStroke:{stroke:"black",width:2,linejoin:"round",opacity:0.7},gridStroke:{width:1,opacity:0.6},boldGridStroke:{width:1,opacity:0.9},yGridStroke:{width:1,dasharray:"2.5,2.5",opacity:0.6},yGridHitStroke:{width:15},yGridLowerStroke:{width:2},chartColor:"#0b61a4",chartTabs:20};for(var b in a){if(typeof c[b]=="undefined"){c[b]=a[b]}}this.id=c.id;this.data=d;this.key=c.key;this.axisOrigin=c.axisOrigin;this.barHeight=c.barHeight;this.barWidth=c.barWidth;this.barChartHeight=c.barChartHeight;this.chartTabs=c.chartTabs;this.pointSize=c.pointSize;this.pointSizeInc=c.pointSizeInc;this.pointHitSize=c.pointHitSize;this.ylabels=c.ylabels;this.yGridHitStroke=c.yGridHitStroke;this.chartHeight=this.barHeight-this.chartTabs*2;this.click=c.click;this.textFromAxisDist=c.textFromAxisDist;this.scoreFromBarDist=c.scoreFromBarDist;this.font=c.font;this.greenFill=c.greenFill;this.redFill=c.redFill;this.gridStroke=c.gridStroke;this.yGridLowerStroke=c.yGridLowerStroke;this.boldGridStroke=c.boldGridStroke;this.yGridStroke=c.yGridStroke;this.chartColor=c.chartColor;this.chartStroke={width:2,color:this.chartColor};this.pointFill={color:this.chartColor};this.numVals=Math.min(this.data.length,10);this.svg=c.svg?c.svg:SVG(this.id).size(c.Width?c.Width:this.barWidth+this.axisOrigin[0]+150,c.Height?c.Height:this.barHeight+this.axisOrigin[1]+80);this.drawPoint=function(h,o,i){var l=h*(this.barWidth/this.numVals)+this.axisOrigin[0];var p=[l,i.value=="1"?this.axisOrigin[1]+this.chartTabs:i.value=="0"?this.axisOrigin[1]+this.barHeight/2:this.axisOrigin[1]+this.barHeight-this.chartTabs];o.push(p);i.chart={};i.chart.line=this.svg.line(l,p[1],l,this.barHeight+this.axisOrigin[0]).fill("none").stroke(this.yGridStroke);i.chart.lowerLine=this.svg.line(l,p[1],l,this.barHeight+this.axisOrigin[0]).fill("none").stroke(this.yGridLowerStroke).opacity(0);i.chart.hitLine=this.svg.line(l,p[1],l,this.barHeight+this.axisOrigin[0]).fill("none").stroke(this.yGridHitStroke).opacity(0);i.chart.point=this.svg.circle(this.pointSize).center(p[0],p[1]).fill(this.pointFill);i.chart.hitPoint=this.svg.circle(this.pointHitSize).center(p[0],p[1]).opacity(0);i.chart.label=this.svg.text(function(f){f.tspan(i.label.time+" ").newLine().dy(11);f.tspan(i.label.date).newLine().dy(10)}).move(12+l,this.axisOrigin[1]+this.barHeight+this.textFromAxisDist[0]).rotate(45,l,this.axisOrigin[1]+this.barHeight).font(this.font).opacity(0.6);var e=this.pointSize,m=this.pointSizeInc,q=this.yGrigHitStroke,k=this.yGrigStroke;var g=function(){i.chart.point.animate(1000,"<>",10).size(m,m);i.chart.label.animate(1,">",10).opacity(1);i.chart.lowerLine.animate(1000,">",10).opacity(0.7)};var j=function(){i.chart.point.animate(1000,"<>",10).size(e,e);i.chart.label.animate(1000,">",10).opacity(0.6);i.chart.lowerLine.animate(1000,">",10).opacity(0)};i.chart.hitPoint.mouseenter(g);i.chart.hitPoint.mouseleave(j);if(this.click){i.chart.hitPoint.click(this.click)}i.chart.hitLine.mouseenter(g);i.chart.hitLine.mouseleave(j);if(this.click){i.chart.hitLine.click(this.click)}i.chart.label.mouseenter(g);i.chart.label.mouseleave(j);if(this.click){i.chart.label.click(this.click)}i.chart.hitPoint.remember(this.key,i);i.chart.hitLine.remember(this.key,i);i.chart.label.remember(this.key,i)};this.drawChart=function(){var h=0;var f=[];for(var e in this.data){var g=this.data[e];if(h>this.numVals){break}this.drawPoint(h++,f,g)}this.svg.polyline(f).fill("none").stroke(this.chartStroke)};this.drawGrid=function(){this.svg.line(this.axisOrigin[0],this.axisOrigin[1]+this.chartTabs,this.axisOrigin[0]+this.barWidth,this.axisOrigin[1]+this.chartTabs).stroke(this.gridStroke);this.svg.line(this.axisOrigin[0],this.axisOrigin[1]+this.barHeight/2,this.axisOrigin[0]+this.barWidth,this.axisOrigin[1]+this.barHeight/2).stroke(this.boldGridStroke);this.svg.line(this.axisOrigin[0],this.axisOrigin[1]+this.barHeight-this.chartTabs,this.axisOrigin[0]+this.barWidth,this.axisOrigin[1]+this.barHeight-this.chartTabs).stroke(this.gridStroke);if(this.ylabels){this.svg.text(this.ylabels[0]).cy(this.axisOrigin[1]+this.chartTabs).x(this.axisOrigin[0]-this.textFromAxisDist[1]).font(this.font);this.svg.text(this.ylabels[1]).cy(this.axisOrigin[1]+this.barHeight/2).x(this.axisOrigin[0]-this.textFromAxisDist[1]).font(this.font);this.svg.text(this.ylabels[2]).cy(this.axisOrigin[1]+this.barHeight-this.chartTabs).x(this.axisOrigin[0]-this.textFromAxisDist[1]).font(this.font)}};this.drawAxis=function(){this.svg.polyline([[this.axisOrigin[0],this.axisOrigin[1]],[this.axisOrigin[0],this.barHeight+this.axisOrigin[0]],[this.axisOrigin[0]+this.barWidth,this.barHeight+this.axisOrigin[0]]]).fill("none").stroke({width:1})};this.remove=function(){$(this.id+" svg").remove()};this.draw=function(){this.drawGrid();this.drawChart();this.drawAxis()};return this};